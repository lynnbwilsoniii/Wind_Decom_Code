	SUBROUTINE FWINDW(IWINDW,NFFT,WINDOW)
C
C	NEARLY  SAME AS [.WIND]FWINDW, BUT ALLOWS VARIABLE NUMBER OF POINTS
C		AND RETURNS WINDOW AS AN ARGUMENT
C
C	COMMON /WINBLK/ WINDOW(1024)
	REAL WINDOW(1)
	DATA TWOPI /6.2831853/
C
	GO TO (100,200,300) IWINDW+1
	PRINT*,'REQUESTED WINDOW DOES NOT EXIST'
 100	CONTINUE
	PRINT*,'IWINDW =',IWINDW,'  NO WINDOWING'
	DO N = 1,NFFT
	  WINDOW(N) = 1.
	ENDDO
	RETURN
 200	CONTINUE
C	PRINT*,'IWINDW =',IWINDW,'  HAMMING'
	ALPHA = .54
	GO TO 310
 300	CONTINUE
	ALPHA = .5
	PRINT*,'IWINDW =',IWINDW,'  HANNING'
 310	CONTINUE
	SUMSQ = 0.
	DO N = 1,NFFT
	  WINDOW(N) = ALPHA + (ALPHA-1.)*COS(TWOPI*(N-1)/NFFT)
	  SUMSQ = SUMSQ + WINDOW(N)**2 
	ENDDO
	RMS = SQRT(SUMSQ/NFFT)
	DO N = 1,NFFT
	  WINDOW(N) = WINDOW(N)/RMS
	ENDDO
	RETURN
	END

