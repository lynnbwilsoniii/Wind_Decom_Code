	SUBROUTINE WVLTGEN(OMEGA,GAMMA,NUMBER,DT,REALP,IMAGP)
C
C	GENERATES REAL AND IMAGINARY PARTS OF A MORLET WAVELET.  I USE
C		THE NOTATION OF TEOLIS "COMPUTATIONAL SIGNAL PROCESSING
C		WITH WAVELETS", EXCEPT THAT HIS GAMMAb IS MY GAMMA^2 AND
C		HIS GAMMAc IS MY OMEGA
C	NOTE THAT GAMMA, NORMALIZATION AND ARGUMENTS ARE DIFFERENT FROM 
C	[KELLOGG.WIND.MAG]MAGWAVELET
C	HERE DT IS THE TIME BETWEEN SAMPLES, AND NUMBER IS THE TOTAL
C	NUMBER OF POINTS (TRUNCATION),  NUMBER IS TURNED INTO THE
C		NEXT LARGEST ODD NUMBER
C
	REAL REALP(100),IMAGP(100)
	DATA TWOPI /6.28318531/
C	
	NO = 2*(NUMBER/2) + 1
	NUMBER = NO
	N2 =  (NO-1)/2	
	N1 = -N2
	XNORM = 0.
	DO N = N1,N2
	  GAUSSF = EXP(-(N*DT/GAMMA)**2)
	  ARG = OMEGA*N*DT
	  REALP(N-N1+1) = GAUSSF*COS(ARG)
	  IMAGP(N-N1+1) = GAUSSF*SIN(ARG) 
	  XNORM = XNORM + GAUSSF**2
	ENDDO
C
C	NORMALIZE
C
	DO N = N1,N2
	  REALP(N-N1+1) = REALP(N-N1+1)/XNORM
	  IMAGP(N-N1+1) = IMAGP(N-N1+1)/XNORM 
	ENDDO
C
	RETURN
	END

