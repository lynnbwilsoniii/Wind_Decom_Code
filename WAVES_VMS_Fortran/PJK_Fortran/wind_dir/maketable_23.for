	program maketable
c
c	make an input table for procipshk from Daniel Berdichevsky
c
	CHARACTER*120 JUNK
	INTEGER HHMMSS,YYYY,HH,DD
C	INTEGER*8 YYYYMMDD
	REAL POS(4)
	DATA POS /4*-1./
C
	OPEN(UNIT=53,FILE='SHOCK_CATALOG.LIST',STATUS='OLD',READONLY)
	READ(53,1001) JUNK
	READ(53,1001) JUNK
	READ(53,1001) JUNK
	READ(53,1001) JUNK
	READ(53,1001) JUNK
	IQUAL = 0
 1001	FORMAT(A)
 100	READ(53,*,END=200,ERR=200) MYDOY,MHHMM
	print*,'read',mydoy,mhhmm
	CALL YDOYTOHHMM(MYDOY,MHHMM,YYYY,MON,DD)
	YYYY = MYDOY/1000
	IF(YYYY.GT.50) THEN
	  YYYY = YYYY + 1900
	ELSE
	  YYYY = YYYY + 2000
	ENDIF
	NULSDY = 4382			! 01 JAN 1994
	NULSYR = 1994
	DOWHILE(NULSYR.LT.YYYY)
	  NULSYR = NULSYR+1
	  NULSDY = NULSDY + 365
	  IF(MOD(NULSYR,4).EQ.0) NULSDY = NULSDY + 1
	ENDDO
	ULSDY = FLOAT(NULSDY + MOD(MYDOY,1000))	
C	YYYYMMDD = 10000*YYYY + 100*MON + DD
	MMDD = 100*MON + DD
	HHMMSS = 100*MHHMM
	PRINT*,'1107',ULSDY,YYYY,MMDD,HHMMSS
	WRITE(91,1107) ULSDY,YYYY,MMDD,HHMMSS,POS,IQUAL
	GO TO 100
 1107	  FORMAT(F8.0,I6,I4.4,I8,4F8.2,I3,F7.3,F4.0,F6.3,F6.0,F6.2,I4)
C	
 200	CONTINUE
	CLOSE(UNIT=53)
	CLOSE(UNIT=91)
	STOP
	END
	SUBROUTINE YDOYTOHHMM(MYDOY,MHHMM,YYYY,MON,DD)
C
	INTEGER YY,DD,HH
	INTEGER MONDAY(12)
	DATA MONDAY /31,28,31,30,31,30,2*31,30,31,30,31/
C
	DD = MOD(MYDOY,1000)
	YY = MYDOY/1000
	MONDAY(2) = 28
	IF(MOD(YY,4).EQ.0) MONDAY(2) = 29
	DO N=1,12
	  MON = N
	  IF(DD.LE.MONDAY(N)) GO TO 120
	  DD = DD - MONDAY(N)
	ENDDO
 120	CONTINUE
	PRINT*,'MONTH,DAY',MYDOY,MHHMM,MON,DD		
	RETURN
	END
