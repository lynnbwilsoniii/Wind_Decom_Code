
	PROGRAM WIND_MODEL
C
C	WRITES A FILE OF INPUTS FOR ESP4
C	THE TOP IS REPRESENTED AS AN OCTAGON WITH THE SAME AREA
C	AS WIND, (no, same r) AND OF COURSE, THERE ARE THEN 8 SIDES
C	THIS VERSION TREATS THE MAG BOOMS AS PLATES
C	THE + AND - X SIDES ARE DIVIDED INTO 2 PARTS
C
	COMPLEX ZSHT(20),VGA(10),ZLDA(10)
	DATA RWIND, HEIGHT /1.22,1.83/
	DIMENSION X(100),Y(100),Z(100),IA(100),IB(100),NAS(10)
	DIMENSION IAB(10),NPLA(10),BDSK(10)
C	
C	CALCULATE AN OCTAGON WITH THE SAME AREA AS TOP OF WIND
C
	RFLAT = RWIND			!TEMPORARY
	RBOOM = .12
C
C	SIDE IS THE LENGTH OF A SIDE, RFLAT IS THE RADIUS TO THE
C		CENTER OF A SIDE
C
	SIDE = 2.*RFLAT*TAND(22.5)
C
	OPEN(UNIT=99,NAME = 'WIND.INPUT',STATUS='NEW')
C
C	DO THE SURFACES OF THE SATELLITE
C
	NPLTS = 14
	WRITE(99,*) NPLTS
	NCRNS = 8
	SEGM = .2
	IREC = 0
	IPN = 3
	IGENSIDE = 0
	ZSHT(1) = CMPLX(0.,0.)
	WRITE(99,1001) NCRNS,SEGM,IREC,IPN,IGENSIDE,ZSHT(1)
 1001	FORMAT(I4,F6.2,3I4,2E12.2)
C
C	TOP AND BOTTOM
C
	X1 = RFLAT
	Y1 = RFLAT*TAND(22.5)
	Z1 = HEIGHT/2.
	WRITE(99,*) X1,Y1,Z1
	DO I = 1,7
	  XT = X1*COSD(45.) - Y1*SIND(45.)
	  Y1 = X1*SIND(45.) + Y1*COSD(45.)
	  X1 = XT
	  WRITE(99,*) X1,Y1,Z1
	ENDDO
	WRITE(99,1001) NCRNS,SEGM,IREC,IPN,IGENSIDE,ZSHT(1)
	X1 = RFLAT
	Y1 = RFLAT*TAND(22.5)
	Z1 = -HEIGHT/2.
	WRITE(99,*) X1,Y1,Z1
	DO I = 1,7
	  XT = X1*COSD(45.) - Y1*SIND(45.)
	  Y1 = X1*SIND(45.) + Y1*COSD(45.)
	  X1 = XT
	  WRITE(99,*) X1,Y1,Z1
	ENDDO
C
C	DO THE SIDES
C		FIRST, THE MAG BOOM SIDE (+X PLATE) IN 2 PIECES
C
	NCRNS = 4
	IREC = 1
	X1 = RFLAT
	Y1 = RFLAT*TAND(22.5)
	Z1 = HEIGHT/2.
	S0 = 0.
	WRITE(99,1001) NCRNS,SEGM,IREC,IPN,IGENSIDE,ZSHT(1)
	WRITE(99,*) X1,-Y1,Z1
	WRITE(99,*) X1,S0,Z1
	WRITE(99,*) X1,S0,-Z1
	WRITE(99,*) X1,-Y1,-Z1
	WRITE(99,1001) NCRNS,SEGM,IREC,IPN,IGENSIDE,ZSHT(1)
	WRITE(99,*) X1,S0,Z1
	WRITE(99,*) X1,Y1,Z1
	WRITE(99,*) X1,Y1,-Z1
	WRITE(99,*) X1,S0,-Z1
C
C	DO MAG BOOM AS PLATE
C
	NCRNS = 4
	IREC = 1
	X1 = RFLAT
	Y1 = 0.
	Z1 = RBOOM
	WRITE(99,1001) NCRNS,SEGM,IREC,IPN,IGENSIDE,ZSHT(1)
	WRITE(99,*) X1,Y1,Z1
	WRITE(99,*) X1,Y1,-Z1
	WRITE(99,*) X1+12.,Y1,-Z1
	WRITE(99,*) X1+12.,Y1,Z1
C
C	THEN THE NEXT 3 SIDES
	NCRNS = 4
	IREC = 1
	X1 = RFLAT
	Y1 = RFLAT*TAND(22.5)
	Z1 = HEIGHT/2.
	DO I = 1,3
	  WRITE(99,1001) NCRNS,SEGM,IREC,IPN,IGENSIDE,ZSHT(1)
	  WRITE(99,*) X1,Y1,Z1
	  WRITE(99,*) X1,Y1,-Z1
	  XT = X1*COSD(45.) - Y1*SIND(45.)
	  Y1 = X1*SIND(45.) + Y1*COSD(45.)
	  X1 = XT
	  WRITE(99,*) X1,Y1,-Z1
	  WRITE(99,*) X1,Y1,Z1
	ENDDO
C
C
C		 THE -X MAG BOOM SIDE IN 2 PIECES
C
	NCRNS = 4
	IREC = 1
	X1 = -RFLAT
	Y1 = RFLAT*TAND(22.5)
	Z1 = HEIGHT/2.
	WRITE(99,1001) NCRNS,SEGM,IREC,IPN,IGENSIDE,ZSHT(1)
	WRITE(99,*) X1,-Y1,Z1
	WRITE(99,*) X1,S0,Z1
	WRITE(99,*) X1,S0,-Z1
	WRITE(99,*) X1,-Y1,-Z1
	WRITE(99,1001) NCRNS,SEGM,IREC,IPN,IGENSIDE,ZSHT(1)
	WRITE(99,*) X1,Y1,Z1
	WRITE(99,*) X1,S0,Z1
	WRITE(99,*) X1,S0,-Z1
	WRITE(99,*) X1,Y1,-Z1
C
C	DO MAG BOOM AS PLATE
	X1 = -RFLAT
	Y1 = 0.
	Z1 = RBOOM
	WRITE(99,1001) NCRNS,SEGM,IREC,IPN,IGENSIDE,ZSHT(1)
	WRITE(99,*) X1,Y1,Z1
	WRITE(99,*) X1,Y1,-Z1
	WRITE(99,*) X1-12.,Y1,-Z1
	WRITE(99,*) X1-12.,Y1,Z1
C
C	THEN THE NEXT SIDES
	NCRNS = 4
	IREC = 1
	X1 = -RFLAT
	Y1 = -RFLAT*TAND(22.5)
	Z1 = HEIGHT/2.
	DO I = 1,3
	  WRITE(99,1001) NCRNS,SEGM,IREC,IPN,IGENSIDE,ZSHT(1)
	  WRITE(99,*) X1,Y1,Z1
	  WRITE(99,*) X1,Y1,-Z1
	  XT = X1*COSD(45.) - Y1*SIND(45.)
	  Y1 = X1*SIND(45.) + Y1*COSD(45.)
	  X1 = XT
	  WRITE(99,*) X1,Y1,-Z1
	  WRITE(99,*) X1,Y1,Z1
	ENDDO
C
C	READ 10, ON PAGE 40, SAVING IMPEDANCE MATRIX
C
	IWRZM = 0
	IRDZM = 0
	WRITE(99,*) IWRZM,IRDZM
C	
C	DO THE WIRES AND MAG BOOMS, AND THE ATTACHMENTS
C		HIGHEST DESIRED FREQUENCY IS 15 MHZ, WAVELENGTH = 20 M
C		A SEGMENT SHOULD BE LESS THAN 1/4 WAVELENGTH LONG
C		SO 12 SEGMENTS FOR X, 2 FOR Y, 2 FOR Z, 3 FOR MAG BOOMS		
C
C	READ 11, OVERALL SPECS
C	DO MAG BOOM AND Y, MONOPOLES
C	NM = 5
C	NP = NM+2
C	NAT = 2
C	NFEEDPT = 0		! EXCLUDING WIRE-TO-PLATE ATTACH. PTS.
C	NFS1 = 1
C	NFS2 = 5
C	WRITE(99,1003) NM,NP,NAT,NFEEDPT,NFS1,NFS2
 1003	FORMAT(10I6)
C	READ 12, COORDINATES OF THE POINTS, MAG BOOM FIRST
C	X(1) = RFLAT
C	Y(1) = 0.
C	Z(1) = 0.
C	WRITE(99,*) X(1),Y(1),Z(1)
C	DH = 4.				! 3 SEGMENTS IN 12 M. FOR MAG BOOM
C	DO I = 2,4
C	  X(I) = X(I-1) + DH
C	  Y(I) = Y(I-1) 
C	  Z(I) = Z(I-1)
C	  WRITE(99,*) X(I),Y(I),Z(I)
C	ENDDO
C
C	DO ANTENNAS
C
	NM = 28
	NP = NM+2
	NAT = 0
	NFEEDPT = 4		! EXCLUDING WIRE-TO-PLATE ATTACH. PTS.
	NFS1 = 0
	NFS2 = 0
	WRITE(99,1003) NM,NP,NAT,NFEEDPT,NFS1,NFS2
C	
C	X ANTENNA
C
	I = 1 	
	X(I) = (RFLAT+50.)/SQRT(2.)
	Y(I) = X(I)
	Z(I) = 0.
	WRITE(99,*) X(I),Y(I),Z(I)
	DHX = -5./SQRT(2.)				! 2 SEGMENTS IN 7.5 M.
	DHY = -5./SQRT(2.)				! 2 SEGMENTS IN 7.5 M.
	DO I = 2,11
	  X(I) = X(I-1) + DHX
	  Y(I) = Y(I-1) + DHY
	  Z(I) = Z(I-1)
	  WRITE(99,*) X(I),Y(I),Z(I)
	ENDDO 	
	WRITE(99,*) S0,S0,Z(I)
	X(I) = -RFLAT/SQRT(2.)
	Y(I) = X(I)
	Z(I) = 0.
	WRITE(99,*) X(I),Y(I),Z(I)
	DO I = 13,22
	  X(I) = X(I-1) + DHX
	  Y(I) = Y(I-1) + DHY
	  Z(I) = Z(I-1)
	  WRITE(99,*) X(I),Y(I),Z(I)
	ENDDO 	
C
C	Y ANTENNA
C
	I = 23
	X(I) = -(RFLAT+7.5)/SQRT(2.)
	Y(I) = -X(I)
	Z(I) = 0.
	WRITE(99,*) X(I),Y(I),Z(I)
	DHX = 3.75/SQRT(2.)				! 2 SEGMENTS IN 7.5 M.
	DHY = -3.75/SQRT(2.)				! 2 SEGMENTS IN 7.5 M.
	DO I = 24,25
	  X(I) = X(I-1) + DHX
	  Y(I) = Y(I-1) + DHY
	  Z(I) = Z(I-1)
	  WRITE(99,*) X(I),Y(I),Z(I)
	ENDDO 
	I = 26
	  WRITE(99,*) S0,S0,Z(I)
	I = 27
	X(I) = RFLAT/SQRT(2.)
	Y(I) = -X(I)
	Z(I) = 0.
	WRITE(99,*) X(I),Y(I),Z(I)
	DO I = 28,29
	  X(I) = X(I-1) + DHX
	  Y(I) = Y(I-1) + DHY
	  Z(I) = Z(I-1)
	  WRITE(99,*) X(I),Y(I),Z(I)
	ENDDO 	
C	
C	READ 13, DEFINE ENDPOINTS OF SEGMENTS
C
	DO I = 1,22
	  IA(I) = I
	  IB(I) = IA(I) + 1
	  WRITE(99,*) IA(I),IB(I)
	ENDDO
	DO I = 23,28
	  IA(I) = I+1
	  IB(I) = IA(I) + 1
	  WRITE(99,*) IA(I),IB(I)
	ENDDO
C
C	READ 14, FEED POINTS, TWO LOADS AND TWO GENERATORS
C
C	  WRITE(99,1002) NAS(I),IAB(I),NPLA(I),VGA(I),ZLDA(I),BDSK(I)
	I = 1
	ISEGM = 10				! x antenna 
	IAB(I) = 1
	VGA(1) = CMPLX(0.,0.)
	ZLDA(1) = CMPLX(1.E7,0.)
	WRITE(99,1004) ISEGM,IAB(I),VGA(I),ZLDA(I)
	ISEGM = 13
	IAB(2) = 0
	WRITE(99,1004) ISEGM,IAB(2),VGA(I),ZLDA(I)
	ISEGM = 24				! y antenna
	IAB(3) = 1
	VGA(1) = CMPLX(1.,0.)
	ZLDA(1) = CMPLX(0.,0.)
	WRITE(99,1004) ISEGM,IAB(3),VGA(1),ZLDA(1)
	ISEGM = 26
	IAB(4) = 0
	WRITE(99,1004) ISEGM,IAB(4),-VGA(1),ZLDA(1)
C
C	READ 15, ATTACHMENT POINTS, THERE ARE NONE
C
C	NAS(1) = 1
C	IAB(1) = 0
C	NPLA(1) = 10
C	VGA(1) = CMPLX(1.,0.)
C	ZLDA(1) = CMPLX(0.,0.)
C	BDSK(1) = .9*SIDE/2.
C	DO I = 1,NAT
C	  WRITE(99,1002) NAS(I),IAB(I),NPLA(I),VGA(I),ZLDA(I),BDSK(I)
C	ENDDO
 1002	FORMAT(3I4,1X,2('(',E10.3,','E10.3,')'),F8.4)
 1004	FORMAT(2I4,1X,2('(',E10.3,','E10.3,')'),F8.4)
	STOP
	END
