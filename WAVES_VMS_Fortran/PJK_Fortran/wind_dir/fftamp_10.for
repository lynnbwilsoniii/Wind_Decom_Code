	FUNCTION FFTAMP(CHANNEL,F)
C
C	THIS IS THE GAIN OF A CIRCUIT JUST BEFORE THE FFT D/A CONVERTER
C
	INTEGER*4 CHANNEL
	COMPLEX Z1,Y2,GAIN
	REAL RSW(6),C2MUF(6),F
	COMMON /GAINBLK/ PHASE,GAIN
	DATA RSW /50.,400.,400.,0.,0.,0./
	DATA C2MUF /1.961,1.896,1.949,1.981,2.011,1.943/
	DATA C1,R2,C2 /2.E-6,1.E4,1.E-9/
	DATA TWOPI /6.2831853/
C
	GAIN = CMPLX(1.,0.)
	PHASE = 0.
	FFTAMP = 1.
	IF(CHANNEL.GT.6) RETURN
	W = TWOPI*F
	C1 = C2MUF(CHANNEL)*1.E-6
	RSWT = RSW(CHANNEL)
	Z1 = CMPLX(RSWT,-1./W/C1)
	Y2 = CMPLX(1./R2,W*C2)
	GAIN = 1./(1. + Y2*Z1)

C
	GNIP = AIMAG(GAIN)
	GNRP = GAIN
	PHASE = ATAN2(GNIP,GNRP)
	FFTAMP = CABS(GAIN)
	RETURN
	END
