	PROGRAM PROCXYDATA
C
C	READS IN A BUNCH OF CALS AND AVERAGES GAIN AND PHASE
C
	CHARACTER*80 FILE,JUNK
	DIMENSION XSPEC(1025),YSPEC(1025),XYDIFF(1025),COUNT(1025)
	DIMENSION PHASE(1025),WT(1025)
	DIMENSION STDX(1025) ,STDY(1025)
	DATA COUNT /1025*1.E-8/
	DATA XSPEC /1025*0./
	DATA YSPEC /1025*0./
	DATA XYDIFF /1025*0./
	DATA PHASE /1025*0./
C
	DO NN = 1,1025
	  STDX(NN) = -32. - 7.*(NN/1024.)**2 - 12.
	  STDY(NN) = STDX(NN) - 6.
	ENDDO
	FLOW = 120./2048.
C*********
C	FLOW=FLOW/4.       		! 30 KHZ SAMPLING			
C	OPEN(UNIT=71,FILE='XYDATA.DAT',STATUS='OLD',READONLY)
	OPEN(UNIT=72,FILE='XYDATA.DAT',STATUS='OLD',READONLY)
	
C
 100	READ(72,1001,END=200) FILE
	PRINT*,FILE
	READ(72,1001) JUNK
	PRINT*,JUNK
 1001	FORMAT(A80,I10)
C
 110	CONTINUE
	DO NN = 1,1025
	  READ(72,*) NPR,XX,YY,PH
	  IF(NN.EQ.2) PRINT*,NPR,XX,YY,PH
	  IF(XX.GT.STDX(NN).AND.YY.GT.STDY(NN)) THEN
C		GUARD AGAINST MISSING EVENTS
	    IF(XX.LT.-1..AND.YY.LT.-1.) THEN
		COUNT(NN) = COUNT(NN) + 1.
		XSPEC(NN) = XSPEC(NN) + XX
		YSPEC(NN) = YSPEC(NN) + YY
		XYDIFF(NN) = XYDIFF(NN) + XX-YY
		PHASE(NN) = PHASE(NN) + PH
	    ENDIF
	  ENDIF
	ENDDO
	GO TO 100
C
 200	CONTINUE
	DO NN = 1,1024
	  XSPEC(NN) = XSPEC(NN)/COUNT(NN)
	  YSPEC(NN) = YSPEC(NN)/COUNT(NN)
	  XYDIFF(NN) = XYDIFF(NN)/COUNT(NN)
	  PHASE(NN) = PHASE(NN)/COUNT(NN)
	  WRITE(69,1002) NN,FLOW*NN,COUNT(NN),XSPEC(NN),YSPEC(NN),
     1		XYDIFF(NN),PHASE(NN)
 1002	  FORMAT(I6,F10.3,F6.0,2E12.4,F8.2,F7.1)
	ENDDO
	STOP
	END
