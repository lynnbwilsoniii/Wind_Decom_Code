	PROGRAM AVERAGE
C
	REAL 	AVPH(1025),AVGAIN(1025),AVCOS(1025),AVSIN(1025)
	REAL	FREQKHZ(1025),AVDB(1025)
	DATA AVPH /1025*0./
	DATA AVDB /1025*0./
	DATA AVGAIN /1025*0./
	DATA AVCOS /1025*0./
	DATA AVSIN /1025*0./
C
	NST = 0
	NFILE = 8
	DO N = 1,NFILE
	  IF(N.EQ.1) OPEN(UNIT=68,FILE='FOR068.DAT;1',STATUS='OLD')
   	  IF(N.EQ.2) OPEN(UNIT=68,FILE='FOR068.DAT;2',STATUS='OLD')
	  IF(N.EQ.3) OPEN(UNIT=68,FILE='FOR068.DAT;3',STATUS='OLD')
	  IF(N.EQ.4) OPEN(UNIT=68,FILE='FOR068.DAT;4',STATUS='OLD')
	  IF(N.EQ.5) OPEN(UNIT=68,FILE='FOR068.DAT;5',STATUS='OLD')
	  IF(N.EQ.6) OPEN(UNIT=68,FILE='FOR068.DAT;9',STATUS='OLD')
	  IF(N.EQ.7) OPEN(UNIT=68,FILE='FOR068.DAT;17',STATUS='OLD')
	  IF(N.EQ.8) OPEN(UNIT=68,FILE='FOR068.DAT;19',STATUS='OLD')
C
 100	  CONTINUE
	  READ(68,*,END=200,ERR=300) FREQ,XSP,YSP,RSP,PH
	  NST = NST+1
	  AVSIN(NST) = AVSIN(NST) + SIND(PH)
	  AVCOS(NST) = AVCOS(NST) + COSD(PH)
	  AVDB(NST) = AVDB(NST) + RSP
	  AVGAIN(NST) = AVGAIN(NST) + 10.**(.1*RSP)
	  FREQKHZ(NST) = FREQ
	  GO TO 100
 200	  CONTINUE
	  NST = 0
	  CLOSE(UNIT=68)
	ENDDO
C
	DO NST = 1,1024
	  AVGAIN(NST) = 10.*ALOG10(AVGAIN(NST)/NFILE)
	  AVPH(NST) = 57.296*ATAN2(AVSIN(NST)/NFILE,AVCOS(NST)/NFILE)
	  WRITE(69,210) FREQKHZ(NST),AVCOS(NST)/NFILE,AVSIN(NST)/NFILE
     1 		,AVDB(NST)/NFILE,AVGAIN(NST),AVPH(NST)
 210	  FORMAT(F10.2,5F10.3)
	ENDDO	
 300	CONTINUE
	PRINT*,'READ ERROR,N,NST=',N,NST
	STOP
	END
