	FUNCTION XPAACold(F)
C
C	THIS FUNCTION RETURNS THE GAIN OF THE AC CHANNEL OF THE WIND X PREAMP
C	THE FUNCTION ITSELF RETURNS THE MAGNITUDE OF THE GAIN, AND THE PHASE
C	AND THE COMPLEX GAIN ARE RETURNED IN A COMMON BLOCK
C
	COMMON /GAINBLK/ PHASE,CGAIN        		  ! PHASE IS IN RADIANS
	COMMON /COMPBLK/ CVAR(10)
C
C	COMPONENT DESIGNATIONS ARE SAME AS SCHEMATIC
C
	COMPLEX CGAIN,Y1,Z1,Y2,Z2,Y3,Z3,OPAMPIN
	DATA R9,C9,R10,CINP /5.E8,22.E-12,5.E8,4.51E-12/
	DATA C29,R43,C12,R28/ 1.E-7,47.E+3,15.E-9,100.E+3/
	DATA R29,C13,R12,C26/ 470.,3.3E-9,10.E3,100.E-9/
	DATA C15,R32,C27,R11/ 0.,10.E3,470.E-12,1.5E3/
	DATA C25,R39,C30/470.E-9,330.,33.E-9/ 
	DATA RCOMP,CCOMP /22.1E3,47.E-12/
	DATA TWOPI /6.2831853/
C
C	TO BE CHANGED FOR Y,Z:  R11,R32,C27,R9,C9,R10
C
	C16 = 1.185E-9                            ! ADJUSTING EY
	C9  = 24.5E-12                            ! ADJUSTING EY
	CINP = 4.757E-12                          ! ADJUSTING EY
C
	C30 = 30.9E-9                     ! ADJUSTING EX
	C13 = 3.7E-9                     ! ADJUSTING EX
C
	C30 = CVAR(1)
	C26 = CVAR(2)
	C25 = CVAR(3)
	C13 = CVAR(4)
	C29 = CVAR(5)
	C12 = CVAR(6)
C
	W = TWOPI*F
	CGAIN = 1.
C	DIVISION OF SIGNAL BEFORE FOLLOWER
C	THIS PART IS USED TO DETERMINE THE INPUT CAPACITANCE, BUT WHEN
C	THE EXPERIMENT IS INTEGRATED, THIS PART IS COMPENSATED BY A
C	CIRCUIT IN THE MAIN BOX, SO IS TO BE COMMENTED OUT, AND REPLACED
C	BY A FIXED GAIN.
C
	Y1 = CMPLX(1./R9,W*C9)
	Y2 = CMPLX(1./R10,W*CINP)
	Z1 = 1./Y1
	Z2 = 1./Y2
	CGAIN = CGAIN*Z2/(Z1+Z2)
C
C	CGAIN = 3.2
C
C	EFFECT OF OUTPUT OP AMP
C	
C	FILTERING BEFORE INPUT
	Z1 = R28                 	! LAST LOAD BEFORE OP AMP
	WC12 = W*C12
	Z2 = CMPLX(R28,-1./WC12)        !  LAST RC
	Y1 = 1./CMPLX(R43,0.) + 1./Z2   !  LAST RC IN PARALLEL WITH R43
	WC29 = W*C29                    
	Z3 = 1./Y1 + CMPLX(0.,-1./WC29) !  LOAD ON FOLLOWER
	OPAMPIN = CGAIN*(Z1/Z2)*(1./Y1/Z3)
C
C	OP AMP GAIN
C
C	Z3 FROM NEG. INPUT TO GROUND
	WC13 = W*C13
	Z1 = CMPLX(R29,-1./WC13)
	WC26 = W*C26
	Z2 = CMPLX(R12,-1./WC26)
	Y1 = 1./Z1 + 1./Z2                  ! Y FROM NEG INPUT TO GROUND
	Z3 = 1./Y1                          ! Z FROM NEG INPUT TO GROUND
C	Z2 FROM OUTPUT TO NEG INPUT
	WC27 = W*C27
	Z1 = CMPLX(R11,-1./WC27)
	WC15 = W*C15
	Y1 = CMPLX(1./R32,WC15)
	Y2 = Y1 + 1./Z1 
	Z2 = 1./Y2
	CGAIN = OPAMPIN*(Z3 + Z2)/Z3
C
C	FILTERING AFTER OP AMP OUTPUT
C
	WC30 = W*C30
	Z1 = CMPLX(R39,-1./WC30)
	WC25 = W*C25
	Z2 = CMPLX(0.,-1./WC25)
	CGAIN = CGAIN*CMPLX(0.,-1./WC30)/(Z2+Z1)	
C
C	EFFECT OF INPUT BOARD
C
	WCC = W*CCOMP
	Z1 = CMPLX(0.,-1./WCC)	
	Z2 = CMPLX(RCOMP,-1./WCC)	
	Z3 = Z1/(Z1+Z2)
C*****************
C	CGAIN = CGAIN*Z3*Z3
C*************
C
	GNIP = AIMAG(CGAIN)
	GNRP = CGAIN
	PHASE = ATAN2(GNIP,GNRP)
	XPAAC = CABS(CGAIN)
	RETURN
	END

